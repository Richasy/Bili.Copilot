<?xml version="1.0" encoding="utf-8" ?>
<local:MpvPlayerControlBase
    x:Class="BiliCopilot.UI.Controls.Core.VideoPlayerOverlay"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:animations="using:CommunityToolkit.WinUI.Animations"
    xmlns:base="using:Richasy.WinUIKernel.Share.Base"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:ext="using:BiliCopilot.UI.Extensions"
    xmlns:local="using:BiliCopilot.UI.Controls.Core"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d">

    <Grid>
        <Rectangle
            HorizontalAlignment="Stretch"
            VerticalAlignment="Stretch"
            Fill="Black"
            Visibility="{x:Bind ViewModel.IsBackdropVisible, Mode=OneWay}" />
        <base:LoadingWidget
            HorizontalAlignment="Center"
            VerticalAlignment="Center"
            Text="{ext:Locale Name=LoadingAndWait}"
            Visibility="{x:Bind ViewModel.IsSourceLoading, Mode=OneWay}" />
        <Grid Visibility="{x:Bind ViewModel.IsSourceLoading, Mode=OneWay, Converter={StaticResource BoolToVisibilityReverseConverter}}">
            <Grid.RowDefinitions>
                <RowDefinition Height="48" />
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>
            <Rectangle HorizontalAlignment="Stretch" Visibility="{x:Bind ViewModel.IsControlVisible, Mode=OneWay}">
                <Rectangle.Fill>
                    <SolidColorBrush Opacity="0.6" Color="{ThemeResource SystemChromeLowColor}" />
                </Rectangle.Fill>
            </Rectangle>
            <base:AppTitleBar
                x:Name="HeaderBar"
                Title="{x:Bind Source.Title, Mode=OneWay}"
                Visibility="{x:Bind ViewModel.IsControlVisible, Mode=OneWay}">
                <base:AppTitleBar.IconElement>
                    <ImageIcon Source="ms-appx:///Assets/StoreLogo.png" />
                </base:AppTitleBar.IconElement>
                <animations:Implicit.ShowAnimations>
                    <animations:OpacityAnimation
                        From="0.0"
                        To="1.0"
                        Duration="0:0:0.2" />
                </animations:Implicit.ShowAnimations>
                <animations:Implicit.HideAnimations>
                    <animations:OpacityAnimation
                        From="1.0"
                        To="0.0"
                        Duration="0:0:0.2" />
                </animations:Implicit.HideAnimations>
            </base:AppTitleBar>
            <base:LoadingWidget
                Grid.Row="1"
                HorizontalAlignment="Center"
                VerticalAlignment="Center"
                Text="{ext:Locale Name=LoadingAndWait}"
                Visibility="{x:Bind ViewModel.IsMediaLoading, Mode=OneWay}" />
            <Grid Grid.Row="1" Visibility="{x:Bind ViewModel.IsMediaLoading, Mode=OneWay, Converter={StaticResource BoolToVisibilityReverseConverter}}" />
        </Grid>
    </Grid>

</local:MpvPlayerControlBase>
