import{_ as s,c as e,a0 as t,o as a}from"./chunks/framework.CoDf8mVe.js";const n="/assets/plugin-new-project.lFyDY_3m.png",l="/assets/plugin-item.jNMAxtGu.png",h="/assets/plugin-publish.MqZrN6ab.png",p="/assets/plugin-folder.CBWaxolJ.png",y=JSON.parse('{"title":"Plugin Development","description":"","frontmatter":{},"headers":[],"relativePath":"en/tool-dev.md","filePath":"en/tool-dev.md","lastUpdated":null}'),o={name:"en/tool-dev.md"};function r(k,i,d,c,g,u){return a(),e("div",null,i[0]||(i[0]=[t('<h1 id="plugin-development" tabindex="-1">Plugin Development <a class="header-anchor" href="#plugin-development" aria-label="Permalink to &quot;Plugin Development&quot;">​</a></h1><div class="tip custom-block github-alert"><p class="custom-block-title">TIP</p><p>Currently, Rodel Agent&#39;s plugins have only been tested on C#. There have been no additional tests on Python and Java, so their functionality is not guaranteed.</p></div><h2 id="principle" tabindex="-1">Principle <a class="header-anchor" href="#principle" aria-label="Permalink to &quot;Principle&quot;">​</a></h2><p>The overall operational architecture of Rodel Agent is based on <a href="https://github.com/microsoft/semantic-kernel" target="_blank" rel="noreferrer">semantic-kernel</a>. The plugin part corresponds to <a href="https://learn.microsoft.com/en-us/semantic-kernel/agents/plugins/using-the-kernelfunction-decorator?tabs=Csharp" target="_blank" rel="noreferrer">Native Functions</a>.</p><p>If you need to develop plugins for Rodel Agent, you are essentially creating a Class Library, then introducing relevant packages of the semantic kernel, following the <a href="https://learn.microsoft.com/en-us/semantic-kernel/agents/plugins/using-the-kernelfunction-decorator?tabs=Csharp" target="_blank" rel="noreferrer">Native Functions</a> guidelines to build the plugin, publish the DLL, and then import the assembly into Rodel Agent. Rodel Agent will use reflection to obtain the list of functions defined in your code, thus realizing local function calls in the semantic kernel.</p><h2 id="development-environment" tabindex="-1">Development Environment <a class="header-anchor" href="#development-environment" aria-label="Permalink to &quot;Development Environment&quot;">​</a></h2><table tabindex="0"><thead><tr><th></th><th></th></tr></thead><tbody><tr><td>Development Tools</td><td>Visual Studio 2022 or Visual Studio Code</td></tr><tr><td>SDK</td><td>.NET 8</td></tr></tbody></table><h2 id="create-project" tabindex="-1">Create Project <a class="header-anchor" href="#create-project" aria-label="Permalink to &quot;Create Project&quot;">​</a></h2><p>For simplicity, create a Class Library based on .NET 8 (it can actually be any .NET version, including .NET Standard 2.0 / .NET 6, etc., but not .NET Framework). We can name it <code>RodelAgent.Samples.Plugin</code>.</p><p><img src="'+n+`" alt="Create New Project"></p><div class="tip custom-block github-alert"><p class="custom-block-title">TIP</p><p>The sample code created in this article is here: <a href="https://github.com/Richasy/Rodel.Agent/tree/main/src/Samples/RodelAgent.Samples.Plugin" target="_blank" rel="noreferrer">Samples</a></p></div><h2 id="import-nuget-packages" tabindex="-1">Import nuget Packages <a class="header-anchor" href="#import-nuget-packages" aria-label="Permalink to &quot;Import nuget Packages&quot;">​</a></h2><p>We only need to use <code>KernelFunction</code> and other features, so just import <a href="https://www.nuget.org/packages/Microsoft.SemanticKernel.Abstractions/" target="_blank" rel="noreferrer">Microsoft.SemanticKernel.Abstractions</a>.</p><p>After importing, the <code>csproj</code> file looks like this:</p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Project</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Sdk</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Microsoft.NET.Sdk&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">PropertyGroup</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">TargetFramework</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;net8.0&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">TargetFramework</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">ImplicitUsings</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;enable&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">ImplicitUsings</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Nullable</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;enable&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Nullable</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">PropertyGroup</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">ItemGroup</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    &lt;!-- The version below is not necessarily accurate, just need to be the latest version --&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">PackageReference</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Include</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Microsoft.SemanticKernel.Abstractions&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Version</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;1.14.1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> /&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">ItemGroup</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Project</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><h2 id="create-plugin-type" tabindex="-1">Create Plugin Type <a class="header-anchor" href="#create-plugin-type" aria-label="Permalink to &quot;Create Plugin Type&quot;">​</a></h2><p>The first naming convention of Rodel Agent:</p><div class="important custom-block github-alert"><p class="custom-block-title">IMPORTANT</p><p>Plugin types should have the <code>Plugin</code> suffix.</p></div><p>Suppose we want to create a weather plugin, then we need to create a new class in the project: <code>WeatherPlugin</code>:</p><div class="language-csharp vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">csharp</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> System</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ComponentModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Microsoft</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">SemanticKernel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">namespace</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> MyPlugins</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Test</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">DisplayName</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Weather Plugin&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Description</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;This plugin can get weather-related information.&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> sealed</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> WeatherPlugin</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>In the above type definition, we need to use <code>DisplayNameAttribute</code> for the title of the plugin and <code>DescriptionAttribute</code> for the description of the plugin. They will be displayed in the plugin list of the application.</p><div style="max-width:320px;"><p><img src="`+l+`" alt="Plugin Entry"></p></div><h2 id="implement-methods" tabindex="-1">Implement Methods <a class="header-anchor" href="#implement-methods" aria-label="Permalink to &quot;Implement Methods&quot;">​</a></h2><p>Now we need to add a method that can get the weather. Here, we use a pseudo-code, which you can replace with a specific implementation.</p><div class="language-csharp vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">csharp</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">KernelFunction</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Description</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Get the weather of a city.&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> async</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Task</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">GetWeatherAsync</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    [</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Description</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;City name&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">string</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> city</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    CancellationToken</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> cancellationToken</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> default</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Task.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Delay</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, cancellationToken);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    var</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> testText</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;The weather of &quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> city </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot; is sunny. 26℃.&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> testText;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>First, we create an asynchronous method named <code>GetWeatherAsync</code> because actual code usually involves network requests, which are asynchronous.</p><p>Then, we need to add two attributes to this method.</p><table tabindex="0"><thead><tr><th></th><th></th></tr></thead><tbody><tr><td>KernelFunctionAttribute</td><td>Identifies that this is a callable method</td></tr><tr><td>DescriptionAttribute</td><td>Provides a description of the method. It is best to use English, as this helps the model determine whether to call this method</td></tr></tbody></table><p><code>GetWeatherAsync</code> has two parameters.</p><p>The first is a required parameter, which is the city name here. You can use <code>DescriptionAttribute</code> to explain it.</p><p>The second is a required parameter for asynchronous methods, which is <code>CancellationToken</code>. During the whole process of calling the tool, if the user clicks cancel, this termination token will spread from the application to this method, thus stopping the execution of the method.</p><p>In this method, we simply return a dynamic text.</p><p>Now, we have completed the coding work of the plugin.</p><p>How simple is that?</p><h2 id="packaging" tabindex="-1">Packaging <a class="header-anchor" href="#packaging" aria-label="Permalink to &quot;Packaging&quot;">​</a></h2><p>After completing the plugin coding, the next step is packaging.</p><p>Right-click on the project and select <code>Publish</code>. You can package and publish the plugin according to the following configuration (choose the publishing location by yourself):</p><p><img src="`+h+'" alt="Library Publish"></p><p>After creating the configuration, click the <code>Publish</code> button in the upper right corner of the publishing page.</p><div class="tip custom-block github-alert"><p class="custom-block-title">TIP</p><p>If you are preparing to publish for ARM64, please select Release | ARM64, and the corresponding win-arm64 runtime.</p></div><p>Wait for the publishing build to complete, then open the publishing folder, you will see a bunch of dll files.</p><p><img src="'+p+'" alt="Plugin Publish Folder"></p><p>Next, select all, right-click, and compress into a ZIP file.</p><p>Most importantly, you need to rename the compressed file to your project name, that is <code>RodelAgent.Samples.Plugin.zip</code>.</p><p>This is the second naming convention of Rodel Agent:</p><div class="important custom-block github-alert"><p class="custom-block-title">IMPORTANT</p><p><strong>When importing plugins, Rodel Agent will look for a dll file with the same name as the ZIP in the compressed package, and import it as an assembly. Therefore, the name of the plugin package must match the name of the dll you want to import.</strong></p></div><h3 id="about-icons" tabindex="-1">About Icons <a class="header-anchor" href="#about-icons" aria-label="Permalink to &quot;About Icons&quot;">​</a></h3><p>You can create an icon for your plugin. This is the third naming convention of Rodel Agent:</p><div class="important custom-block github-alert"><p class="custom-block-title">IMPORTANT</p><p>You can add an image named <code>favicon.png</code> in the compressed package as the plugin icon.</p></div><h2 id="import" tabindex="-1">Import <a class="header-anchor" href="#import" aria-label="Permalink to &quot;Import&quot;">​</a></h2><p>Refer to <a href="./chat-tools#导入工具插件">Tool Calling</a> to import the ZIP compressed package into Rodel Agent.</p><h2 id="plugin-update" tabindex="-1">Plugin Update <a class="header-anchor" href="#plugin-update" aria-label="Permalink to &quot;Plugin Update&quot;">​</a></h2><p>In Rodel Agent, plugins are loaded in the form of importing external DLLs. During the running of the application, new ZIPs cannot directly replace old plugins.</p><p>If you need to update the plugin, please close Rodel Agent, delete the corresponding plugin folder in the <code>Plugins</code> subfolder of the assistant library folder, then open the application and re-import the new plugin.</p><h2 id="q-a" tabindex="-1">Q&amp;A <a class="header-anchor" href="#q-a" aria-label="Permalink to &quot;Q&amp;A&quot;">​</a></h2><ol><li><p><strong>Why use <code>Publish</code>, can&#39;t we use the directly built DLL?</strong><br> Choosing <code>Publish</code> is because it can include all the DLLs that this project depends on. When loading the main DLL file, if dependencies are missing, Rodel Agent will search for dependencies in the plugin directory and load them.<br> Directly using the built DLL is likely to cause dependency issues.</p></li><li><p><strong>Why is the plugin list empty after I imported the plugin?</strong><br> Clearly, something went wrong.<br> Please open the settings page, open the application log folder, find the log of the day, open and view the log records, and troubleshoot accordingly.</p></li><li><p><strong>Can there be multiple plugins in one project?</strong><br> Yes, one plugin per type is fine. After importing, each plugin type is a plugin entry, sharing the same icon.</p></li></ol>',56)]))}const m=s(o,[["render",r]]);export{y as __pageData,m as default};
